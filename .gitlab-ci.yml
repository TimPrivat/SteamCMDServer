DockerSetup:
  stage: setup
  script:
    - export DOCKER_HOST=$DOCKER_HOST
    - eval $(ssh-agent)
    - ssh-add ~/.ssh/privatekey
    - sleep 5
    - docker build -t steamcmd .

.DockerBuild:
  stage: build
  script:
    - docker build -t steamcmd .

DockerRun:
  stage: run
  script:
    - docker run --rm --name steamcmd steamcmd

DockerCleanup:
  stage: cleanup
  script:
    - unset DOCKER_HOST

stages:
  - setup
  - run
  - cleanup